---
title: 网络分层及TCP、HTTP协议
date: 2018-02-08 14:43:14
categories: Android网络开发
---

> 在Android中的网络编程中，我们需要了解基本的网络分层和最主要的几个协议

### 网络分层

在我所学的《计算机网络》课本中，将网络分为物理层、数据链路层、网络层、传输层与应用层，这是一个自底而上的顺序，叫做五层协议体系模型；而在OSI七层体系模型中，则把应用层又分为了会话层、表示层与应用层，具体为：

> 物理层、数据链路层、网络层、传输层、会话层、表示层、应用层

TCP协议是属于传输层的协议，而HTTP协议在两个分层中都是属于应用层协议

### TCP

#### 三次握手

我们进行HTTP连接网络时会进行TCP的三次握手，然后传输数据，之后再释放连接，过程如下：

1. 第一次握手：客户端向服务端发送SYN请求报文段，进入SYN_SENT状态
2. 第二次握手：服务器收到客户端发来的SYN请求报文段，发送SYN+ACK报文段，进入SYN_REVD状态
3. 第三次握手：客户端收到服务端的SYN+ACK报文段，向服务器发送ACK报文段，发送完毕后，客户端和服务器都进入ESTABLISHED状态

#### 四次挥手

建立连接后，当数据传送完毕，断开连接我们就需要进行四次挥手：

1. 第一次挥手：客户端向服务端发送FIN报文段，进入FIN_WAIT_1状态，此时客户端已经没有数据需要发送给服务端了
2. 第二次挥手：服务端收到了客户端发送的FIN报文段，向客户端发送ACK报文段
3. 第三次挥手：服务端发送FIN报文段，进入LAST_ACK状态
4. 第四次挥手：客户端收到服务端发送的FIN报文段，向服务端发送ACK报文段，服务端收到ACK报文后就关闭连接。客户端在等待最大报文生存时间后没有收到回复，客户端也关闭连接

### HTTP

HTTP是应用层的协议，它假定在下层的协议是可靠的，所以我们一般使用TCP/IP协议作为它的下层协议来使用

HTTP请求方法又8种，分别为：

* GET：请求获取Request-URI所标识的资源
* POST：在Request-URI所标识的资源后附加新的数据
* HEAD：请求获取由Request-URI所标识的资源的相应消息报头
* PUT：请求服务器存储一个资源，并用Request-URI作为其标识
* DELETE：请求服务器删除Request-URI所标识的资源
* TRACE：请求服务器回送收到的请求消息，用于测试或诊断
* CONNECT：在1.1版本中将连接改为管道方式的代理服务器
* OPTIONS：请求查询服务器的性能，或者查询与资源相关的选项和需求

HTTP响应状态码：

* 1XX：指示信息，收到请求，需要请求者继续执行操作
* 2XX：请求成功，请求已成功被处理
* 3XX：重定向，要完成请求必须进行更进一步的操作
* 4XX：客户端错误，请求有语法错误或无法实现
* 5XX：服务器错误，服务器不能实现合法的请求

